
SQL Test 2 SET A

mysql> use mywork;
Database changed

mysql> create table salesman(salesman_id int, name varchar(50),city varchar(50),commission decimal(5,2));
Query OK, 0 rows affected (0.07 sec)

mysql> insert into salesman values(5001,"James Hoog","New York",0.15)
    -> ,(5002,"Nail Knite","Paris",0.13)
    -> ,(5005,"Pit Alex","London",0.11)
    -> ,(5006,"Mc Lyon","Paris",0.14)
    -> ,(5007,"Paul Adam","Rome",0.13)
    -> ,(5003,"Lauson Hen","San Jose",0.12);
Query OK, 6 rows affected (0.07 sec)

mysql> table salesman;
+-------------+------------+----------+------------+
| salesman_id | name       | city     | commission |
+-------------+------------+----------+------------+
|        5001 | James Hoog | New York |       0.15 |
|        5002 | Nail Knite | Paris    |       0.13 |
|        5005 | Pit Alex   | London   |       0.11 |
|        5006 | Mc Lyon    | Paris    |       0.14 |
|        5007 | Paul Adam  | Rome     |       0.13 |
|        5003 | Lauson Hen | San Jose |       0.12 |
+-------------+------------+----------+------------+

mysql> create table customer(customer_id int, cust_name varchar(50),city varchar(50),grade int,salesman_id int);
Query OK, 0 rows affected (0.06 sec)

mysql> insert into customer
    -> values(3002,"Nick Rimando","new york",100,5001),
    -> (3007,"Brad Davis","New York",200,5001),
    -> (3005,"Graham Zusi","California",200,5002),
    -> (3008,"Julian Green","London",300,5002),
    -> (3004,"Fabian Johnson","Paris",300,5006),
    -> (3009,"Geoff Cameron","Berlin",100,5003),
    -> (3003,"Jozv Altidor","Moscow",200,5007);
Query OK, 7 rows affected (0.01 sec)
Records: 7  Duplicates: 0  Warnings: 0

mysql> table customer;
+-------------+----------------+------------+-------+-------------+
| customer_id | cust_name      | city       | grade | salesman_id |
+-------------+----------------+------------+-------+-------------+
|        3002 | Nick Rimando   | new york   |   100 |        5001 |
|        3007 | Brad Davis     | New York   |   200 |        5001 |
|        3005 | Graham Zusi    | California |   200 |        5002 |
|        3008 | Julian Green   | London     |   300 |        5002 |
|        3004 | Fabian Johnson | Paris      |   300 |        5006 |
|        3009 | Geoff Cameron  | Berlin     |   100 |        5003 |
|        3003 | Jozv Altidor   | Moscow     |   200 |        5007 |
+-------------+----------------+------------+-------+-------------+

mysql> create table orders(ord_no int,purch_amt decimal(5,2),ord_date date,customer_is int,salesman_id int);
Query OK, 0 rows affected (0.03 sec)

mysql> insert into orders values(70001,150.5,"2012-10-05",3005,5002),
    -> (70009,270.65,"2012-09-10",3001,5005),
    -> (70002,65.26,"2012-10-05",3002,5001),
    -> (70004,110.5,"2012-08-17",3009,5003),
    -> (70007,948.5,"2012-09-10",3005,5002),
    -> (70005,2400.6,"2012-07-27",3007,5001),
    -> (70008,5760.0,"2012-09-10",3002,5001);
Query OK, 7 rows affected (0.03 sec)

mysql> table orders;
+--------+-----------+------------+-------------+-------------+
| ord_no | purch_amt | ord_date   | customer_is | salesman_id |
+--------+-----------+------------+-------------+-------------+
|  70001 |    150.50 | 2012-10-05 |        3005 |        5002 |
|  70009 |    270.65 | 2012-09-10 |        3001 |        5005 |
|  70002 |     65.26 | 2012-10-05 |        3002 |        5001 |
|  70004 |    110.50 | 2012-08-17 |        3009 |        5003 |
|  70007 |    948.50 | 2012-09-10 |        3005 |        5002 |
|  70005 |   2400.60 | 2012-07-27 |        3007 |        5001 |
|  70008 |   5760.00 | 2012-09-10 |        3002 |        5001 |
+--------+-----------+------------+-------------+-------------+
7 rows in set (0.00 sec)


--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

1. Write a SQL statement to display all the information of all salesmen

mysql> select * from salesman;
+-------------+------------+----------+------------+
| salesman_id | name       | city     | commission |
+-------------+------------+----------+------------+
|        5001 | James Hoog | New York |       0.15 |
|        5002 | Nail Knite | Paris    |       0.13 |
|        5005 | Pit Alex   | London   |       0.11 |
|        5006 | Mc Lyon    | Paris    |       0.14 |
|        5007 | Paul Adam  | Rome     |       0.13 |
|        5003 | Lauson Hen | San Jose |       0.12 |
+-------------+------------+----------+------------+
6 rows in set (0.00 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
2. Write a query to display the columns in descending order of purchase amount from for all 
the orders. 

mysql> select * from orders
    -> order by purch_amt desc;
+--------+-----------+------------+-------------+-------------+
| ord_no | purch_amt | ord_date   | customer_is | salesman_id |
+--------+-----------+------------+-------------+-------------+
|  70008 |   5760.00 | 2012-09-10 |        3002 |        5001 |
|  70005 |   2400.60 | 2012-07-27 |        3007 |        5001 |
|  70007 |    948.50 | 2012-09-10 |        3005 |        5002 |
|  70009 |    270.65 | 2012-09-10 |        3001 |        5005 |
|  70001 |    150.50 | 2012-10-05 |        3005 |        5002 |
|  70004 |    110.50 | 2012-08-17 |        3009 |        5003 |
|  70002 |     65.26 | 2012-10-05 |        3002 |        5001 |
+--------+-----------+------------+-------------+-------------+
7 rows in set (0.00 sec)

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

3. Write a SQL statement to display names and city of salesman, who belongs to the city of 
Paris. 

mysql> select name ,city from salesman
    -> where city = "paris";
+------------+-------+
| name       | city  |
+------------+-------+
| Nail Knite | Paris |
| Mc Lyon    | Paris |
+------------+-------+
2 rows in set (0.00 sec)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

4. Write a SQL query to display the order number followed by order date and the purchase 
amount for each order which will be delivered by the salesman who is holding the ID 5001.

mysql> select ord_no,ord_date,purch_amt from orders
    -> where salesman_id="5001";
+--------+------------+-----------+
| ord_no | ord_date   | purch_amt |
+--------+------------+-----------+
|  70002 | 2012-10-05 |     65.26 |
|  70005 | 2012-07-27 |   2400.60 |
|  70008 | 2012-09-10 |   5760.00 |
+--------+------------+-----------+
3 rows in set (0.01 sec)

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
5. Write a SQL statement to find the average commission that a salesman get. 

mysql> select avg(commission) from salesman;
+-----------------+
| avg(commission) |
+-----------------+
|        0.130000 |
+-----------------+
1 row in set (0.01 sec)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

6. Write a SQL statement to find the number of salesmen currently listing for all of their 
customers.

mysql> select count(distinct salesman_id) from customer;
+-----------------------------+
| count(distinct salesman_id) |
+-----------------------------+
|                           5 |
+-----------------------------+
1 row in set (0.01 sec)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
7. Write a SQL statement to find the highest purchase amount ordered by the each customer 
with their ID and highest purchase amount.

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 
8. Write a SQL statement to find the names of all customers along with the salesmen who 
works for them 

mysql> select cust_name, name from customer
    -> c inner join salesman s
    -> on c.salesman_id = s.salesman_id;
+----------------+------------+
| cust_name      | name       |
+----------------+------------+
| Nick Rimando   | James Hoog |
| Brad Davis     | James Hoog |
| Graham Zusi    | Nail Knite |
| Julian Green   | Nail Knite |
| Fabian Johnson | Mc Lyon    |
| Geoff Cameron  | Lauson Hen |
| Jozv Altidor   | Paul Adam  |
+----------------+------------+
7 rows in set (0.00 sec)

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

9. Write a SQL statement that finds out each order number followed by the name of the 
customers who made the order. 

mysql> select ord_no,cust_name from orders o
    -> join customer c
    -> on o.customer_is=c.customer_id;
+--------+---------------+
| ord_no | cust_name     |
+--------+---------------+
|  70008 | Nick Rimando  |
|  70002 | Nick Rimando  |
|  70005 | Brad Davis    |
|  70007 | Graham Zusi   |
|  70001 | Graham Zusi   |
|  70004 | Geoff Cameron |
+--------+---------------+
6 rows in set (0.01 sec)

----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

10. Write a query to find all the orders issued against the salesman who may works for 
customer whose id is 3007

mysql> select * from orders
    -> where customer_is = 3007;
+--------+-----------+------------+-------------+-------------+
| ord_no | purch_amt | ord_date   | customer_is | salesman_id |
+--------+-----------+------------+-------------+-------------+
|  70005 |   2400.60 | 2012-07-27 |        3007 |        5001 |
+--------+-----------+------------+-------------+-------------+
1 row in set (0.00 sec)
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------